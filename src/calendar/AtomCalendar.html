<script>
    import CalendarViewModel from "./CalendarViewModel";
    import AtomCalendarStyle from "./AtomCalendarStyle";
    import SRCalendar from "./res/SRCalendar";
</script>
<div
    @properties=" selectedDate: Date = null, yearStart:any = -10, yearEnd: any = 10, enableFunc: any = null, currentDate: any, itemTemplate: any"
    @inject=" srCalendar: SRCalendar "
    local-view-model="{ this.resolve(CalendarViewModel, 'owner') }" 
    default-style="{ AtomCalendarStyle }" 
    style-class="[$this.controlStyle.root]">
    <div 
    class="header">
        <i 
            event-click="{ ()=> $localViewModel.changeMonth(-1)}"
            class="fas fa-caret-left"
            title="Previous Month"
            style="margin-right: 15px; font-size: 120%; cursor: pointer; padding:0 10px 0 10px;"></i>

        <AtomComboBox.select
            value-path="value"
            value="$[localViewModel.year]"
            items="[$localViewModel.yearList]">
            <option template="itemTemplate" text="{$data.label}"></option>
        </AtomComboBox.select>
        <AtomComboBox.select
            value-path="value"
            value="$[localViewModel.month]"
            items="{ this.srCalendar.monthList }">
            <option template="itemTemplate" text="{$data.label}"></option>
        </AtomComboBox.select>
        <i 
            event-click="{ ()=> $localViewModel.changeMonth(1)}"
            class="fas fa-caret-right"
            title="Next Month"
            style="margin-left: 15px; font-size: 120%; cursor: pointer; padding:0 10px 0 10px;"></i>
    </div>
    <AtomItemsControl.div
        items="{ this.srCalendar.weekDays }"
        class="week-days">
    </AtomItemsControl.div>
    <AtomItemsControl.div 
        class="month-days"
        item-template="[$this.itemTemplate]"
        items="[$localViewModel.items]">
    </AtomItemsControl.div>  

    <div 
        template="itemTemplate"
        event-click="{ ()=> $localViewModel.dateClicked($data)}">
        <div 
            text="{$data.label}"
            class="[ ({
                'date-css': 1,
                'is-other-month': $data.isOtherMonth,
                'is-today': $data.isToday,
                'is-weekend': $data.isWeekend,
                'is-selected': $localViewModel.selectedDate == $data.value,
                'is-disabled': $localViewModel.enableFunc ? $localViewModel.enableFunc($data) : 0
            }) ]">
        </div>
    </div>

</div>